{% extends 'base.html' %}

{% block content %}
<section class="mb-12">
    <h2 class="text-3xl font-bold text-center mb-6">Manage Blogs</h2>
    <!-- Add Blog Form -->
    <form method="POST" enctype="multipart/form-data" class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h3 class="text-xl font-semibold mb-4">Add New Blog</h3>
        <div class="mb-4">
            <label for="title" class="block text-gray-700">Title</label>
            <input type="text" id="title" name="title" class="w-full border rounded-lg p-2" required>
        </div>
        <div class="mb-4">
            <label for="content" class="block text-gray-700">Content</label>
            <textarea id="content" name="content" class="w-full border rounded-lg p-2" rows="5" required></textarea>
        </div>
        <div class="mb-4">
            <label for="image" class="block text-gray-700">Image</label>
            <input type="file" id="image" name="image" class="w-full" accept="image/*" required>
        </div>
        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">Add Blog</button>
    </form>

    <!-- Edit Blog Form (if editing) -->
    {% if blog %}
    <form method="POST" action="{{ url_for('edit_blog', id=blog.id) }}" enctype="multipart/form-data" class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h3 class="text-xl font-semibold mb-4">Edit Blog</h3>
        <div class="mb-4">
            <label for="title" class="block text-gray-700">Title</label>
            <input type="text" id="title" name="title" value="{{ blog.title }}" class="w-full border rounded-lg p-2" required>
        </div>
        <div class="mb-4">
            <label for="content" class="block text-gray-700">Content</label>
            <textarea id="content" name="content" class="w-full border rounded-lg p-2" rows="5" required>{{ blog.content }}</textarea>
        </div>
        <div class="mb-4">
            <label for="image" class="block text-gray-700">Image (optional)</label>
            <input type="file" id="image" name="image" class="w-full" accept="image/*">
        </div>
        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">Update Blog</button>
    </form>
    {% endif %}

    <!-- Blog List -->
    <h3 class="text-xl font-semibold mb-4">Existing Blogs</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {% for b in blogs %}
        <div class="bg-white rounded-lg shadow-md p-4 flex justify-between items-center">
            <div>
                <h4 class="text-lg font-semibold">{{ b.title }}</h4>
                <p class="text-gray-600">{{ b.content[:100] }}...</p>
            </div>
            <div class="space-x-2">
                <a href="{{ url_for('edit_blog', id=b.id) }}" class="text-blue-600 hover:underline">Edit</a>
                <a href="{{ url_for('delete_blog', id=b.id) }}" class="text-red-600 hover:underline" onclick="return confirm('Are you sure?')">Delete</a>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
<script src="/static/js/admin.js"></script>
{% endblock %}